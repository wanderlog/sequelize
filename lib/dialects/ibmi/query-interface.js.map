{
  "version": 3,
  "sources": ["../../../src/dialects/ibmi/query-interface.js"],
  "sourcesContent": ["'use strict';\n\nconst { Transaction } = require('../../transaction');\nconst { QueryInterface } = require('../abstract/query-interface');\n\n/**\n Returns an object that enables the `ibmi` dialect to call underlying odbc\n transaction functions through the connection methods instead\n\n @class QueryInterface\n @static\n @private\n */\n\nexport class IBMiQueryInterface extends QueryInterface {\n\n  startTransaction(transaction, options) {\n    if (!(transaction instanceof Transaction)) {\n      throw new TypeError('Unable to start a transaction without transaction object!');\n    }\n\n    options = { ...options, transaction: transaction.parent || transaction };\n\n    options.transaction.name = transaction.parent ? transaction.name : undefined;\n\n    return transaction.connection.beginTransaction();\n  }\n\n  commitTransaction(transaction) {\n    if (!(transaction instanceof Transaction)) {\n      throw new TypeError('Unable to commit a transaction without transaction object!');\n    }\n\n    if (transaction.parent) {\n      throw new Error('Unable to commit a transaction that has a parent transaction!');\n    }\n\n    const promise = transaction.connection.commit();\n    transaction.finished = 'commit';\n\n    return promise;\n  }\n\n  rollbackTransaction(transaction, options) {\n    if (!(transaction instanceof Transaction)) {\n      throw new TypeError('Unable to rollback a transaction without transaction object!');\n    }\n\n    options = {\n      ...options,\n      transaction: transaction.parent || transaction,\n      supportsSearchPath: false,\n      completesTransaction: true,\n    };\n    options.transaction.name = transaction.parent ? transaction.name : undefined;\n\n    const promise = transaction.connection.rollback();\n    transaction.finished = 'commit';\n\n    return promise;\n  }\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA,MAAM,EAAE,gBAAgB,QAAQ,mBAAmB;AACnD,MAAM,EAAE,mBAAmB,QAAQ,6BAA6B;AAWzD,MAAM,2BAA2B,eAAe;AAAA,EAErD,iBAAiB,aAAa,SAAS;AACrC,QAAI,CAAE,wBAAuB,cAAc;AACzC,YAAM,IAAI,UAAU,2DAA2D;AAAA,IACjF;AAEA,cAAU,iCAAK,UAAL,EAAc,aAAa,YAAY,UAAU,YAAY;AAEvE,YAAQ,YAAY,OAAO,YAAY,SAAS,YAAY,OAAO;AAEnE,WAAO,YAAY,WAAW,iBAAiB;AAAA,EACjD;AAAA,EAEA,kBAAkB,aAAa;AAC7B,QAAI,CAAE,wBAAuB,cAAc;AACzC,YAAM,IAAI,UAAU,4DAA4D;AAAA,IAClF;AAEA,QAAI,YAAY,QAAQ;AACtB,YAAM,IAAI,MAAM,+DAA+D;AAAA,IACjF;AAEA,UAAM,UAAU,YAAY,WAAW,OAAO;AAC9C,gBAAY,WAAW;AAEvB,WAAO;AAAA,EACT;AAAA,EAEA,oBAAoB,aAAa,SAAS;AACxC,QAAI,CAAE,wBAAuB,cAAc;AACzC,YAAM,IAAI,UAAU,8DAA8D;AAAA,IACpF;AAEA,cAAU,iCACL,UADK;AAAA,MAER,aAAa,YAAY,UAAU;AAAA,MACnC,oBAAoB;AAAA,MACpB,sBAAsB;AAAA,IACxB;AACA,YAAQ,YAAY,OAAO,YAAY,SAAS,YAAY,OAAO;AAEnE,UAAM,UAAU,YAAY,WAAW,SAAS;AAChD,gBAAY,WAAW;AAEvB,WAAO;AAAA,EACT;AACF;",
  "names": []
}
